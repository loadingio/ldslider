(function(){function t(t,i){var s={}.hasOwnProperty;for(var e in i)s.call(i,e)&&(t[e]=i[e]);return t}var i;(i=function(i){var s,e,n,o,l,a,r,h,p=this;if(null==i&&(i={}),this.evtHandler={},this.opt=t({min:0,max:100,from:0,to:0,step:1},i),this.val={to:0,from:0},this.root=s="string"==typeof i.root?document.querySelector(i.root):i.root,"INPUT"===this.root.tagName){for(this.input=this.root,ld$.attr(this.input,"type","hidden"),this.root=s=document.createElement("div"),this.input.parentNode.insertBefore(this.root,this.input),e=0,n=this.input.classList.length;e<n;++e)o=e,this.root.classList.add(this.input.classList[o]);this.input.setAttribute("class",""),(l=this.input.getAttribute("data-class"))&&this.input.classList.add.apply(this.input.classList,l.split(" ")),a=function(){var t;return p.range?(t=(p.input.value||"").split(/\s*~\s*/),t={from:parseFloat((t[0]||"").trim()),to:parseFloat((t[1]||"").trim())},isNaN(t.from)&&(t.from=0),isNaN(t.to)&&(t.from=0),p.repos(t.from,!0,!1,!0,!1),p.repos(t.to,!0,!1,!0,!0)):(t=parseFloat((p.input.value||"").trim()),isNaN(t)&&(t=0),p.repos(t,!0,!1,!0))},this.input.addEventListener("change",a),this.input.addEventListener("input",a)}return this.root._ldrs=this,this.root.classList.add("ldrs"),this.root.innerHTML='<div class="bar">\n  <div class="cap"></div>\n  <div class="cap"></div>\n  <div class="bar-inner">\n    <div class="bk"></div>\n    <div class="fg"></div>\n    <div class="line lock"></div>\n    <div class="line p"></div>\n    <div class="hint p"></div>\n    <div class="line p alt"></div>\n    <div class="hint p alt"></div>\n  </div>\n</div>\n<div class="hint l"></div>\n<div class="hint lock"></div>\n<div class="hint r"></div>',this.el=r={b:{fg:ld$.find(s,".fg",0)},p:ld$.find(s,".line.p",0),q:ld$.find(s,".line.p.alt",0),h:{p:ld$.find(s,".hint.p",0),q:ld$.find(s,".hint.p.alt",0),l:ld$.find(s,".hint.l",0),r:ld$.find(s,".hint.r",0),lock:ld$.find(s,".hint.lock",0),lockLine:ld$.find(s,".lock-line",0)}},h={move:function(t){return 1&t.buttons?p.repos(t.clientX,!0,!0,!1,h.alt):h.up(t)},up:function(){var t,i,s;return document.removeEventListener("mouseup",h.up),document.removeEventListener("mousemove",h.move),t=h.alt?[p.el.h.q,p.val.to]:[p.el.h.p,p.val.from],i=t[0],s=t[1],i.innerText=p.label.ptr(Math.round(1e4*s)/1e4)},prepare:function(t){return h.alt=!!(t.target&&t.target.classList&&t.target.classList.contains("alt")),document.addEventListener("mousemove",h.move),document.addEventListener("mouseup",h.up)}},r.p.addEventListener("mousedown",h.prepare),s.addEventListener("click",h.move),s.addEventListener("mousedown",h.prepare),this.prepare(),this}).prototype=t(Object.create(Object.prototype),{on:function(t,i){var s;return((s=this.evtHandler)[t]||(s[t]=[])).push(i)},fire:function(t){var i,s,e,n,o,l,a,r=[];for(s=[],e=1,n=arguments.length;e<n;++e)s.push(arguments[e]);for(i=s,e=0,l=(o=this.evtHandler[t]||[]).length;e<l;++e)a=o[e],r.push(a.apply(this,i));return r},update:function(){return this.range?this.set(this.val):this.set(this.val.from)},updateInput:function(t){var i,s=this;return i=(null!=t?t:{now:!1}).now,clearTimeout(this.debounce),this.debounce=setTimeout(function(){var t;if(s.range){if(t=s.val.from+" ~ "+s.val.to,s.input.value!==t)return s.input.value=t}else if(s.input.value!==s.val.from)return s.input.value=s.val.from},i?0:500)},edit:function(t){if(this.input)return null==t&&(t="hidden"===this.input.getAttribute("type")),this.input.setAttribute("type",t?"text":"hidden"),this.root.style.display=t?"none":"",t?void 0:this.update()},prepare:function(){var i=this;return null!=this.opt.from&&(this.val.from=this.opt.from),null!=this.opt.to&&(this.val.to=this.opt.to),this.opt.exp&&(this.expFactor=Math.log(this.opt.exp.output||this.opt.max-this.opt.min)/Math.log(this.opt.exp.input)),this.label=t({ptr:function(t){return t===i.opt.min&&null!=i.label.min?i.label.min:t===i.opt.max&&null!=i.label.max?i.label.max:t}},this.opt.label||{}),this.el.h.l.innerText=null!=this.label.min?this.label.min:this.opt.min,this.el.h.r.innerText=null!=this.label.max?this.label.max:this.opt.max,this.el.h.p.innerText=this.label.ptr(this.opt.from),this.el.h.q.innerText=this.label.ptr(this.opt.to),this.root.classList[null!=this.opt.limitMax?"add":"remove"]("limit"),this.range=null!=this.opt.range?this.opt.range:!!this.root.classList.contains("range"),this.range&&this.root.classList.toggle("range",this.range),this.update()},setConfig:function(i){return null==i&&(i={}),this.opt=t({},i),this.prepare()},set:function(t,i){return null==i&&(i=!1),this.range?(this.repos(t.from,i,!1,!1,!1),this.repos(t.to,i,!1,!1,!0)):this.repos(t,i)},get:function(){return this.range?this.val:this.val.from},repos:function(t,i,s,e,n){var o,l,a,r,h,p,u,d,m,v,c,f,x,g,b,M,w;null==i&&(i=!1),null==s&&(s=!1),null==e&&(e=!1),null==n&&(n=!1),o=n?"to":"from",l=this.val[o],a=this.el.h[n?"q":"p"],p=.6*(h=(r=this.el[n?"q":"p"]).parentNode.getBoundingClientRect()).width,s?(c=(u=(d=(v=t-h.x)>0?v:0)<(m=h.width)?d:m)/h.width,this.expFactor&&(c=Math.pow(c,this.expFactor)),f=this.opt.min+(this.opt.max-this.opt.min)*c,null!=this.opt.limitMax&&(u>p?f=this.opt.limitMax+(this.opt.max-this.opt.limitMax)*(u-p)/(h.width-p):(c=u/p,this.expFactor&&(c=Math.pow(c,this.expFactor)),f=this.opt.min+this.opt.limitMax*c))):f=t,f=t=(d=(v=this.opt.min+Math.round((f-this.opt.min)/this.opt.step)*this.opt.step)>(x=this.opt.min)?v:x)<(m=this.opt.max)?d:m,this.val[o]=f,g={};for(b in d=this.val)t=d[b],(this.range||"to"!==b)&&(u=null!=this.opt.limitMax?t>this.opt.limitMax?(t-this.opt.limitMax)/(this.opt.max-this.opt.limitMax)*40+60:this.expFactor?60*Math.pow((t-this.opt.min)/(this.opt.limitMax-this.opt.min),1/this.expFactor):60*(t-this.opt.min)/(this.opt.limitMax-this.opt.min):this.expFactor?100*Math.pow((t-this.opt.min)/(this.opt.max-this.opt.min),1/this.expFactor):(t-this.opt.min)/(this.opt.max-this.opt.min)*100,null!=this.opt.limitMax&&this.opt.limitHard&&(u>60&&(u=60),t>this.opt.limitMax&&(t=this.opt.limitMax)),this.val[b]=t,g[b]=u);if(u=g[o],t=this.val[o],M=this.range?Math.min(g.from,g.to)+.5:0,w=this.range?Math.max(g.from,g.to)-M+.5:g.from,a.getBoundingClientRect(),a.innerText=this.label.ptr(Math.round(1e4*t)/1e4),a.style.left=.01*u*h.width*100/h.width+"%",a.style.transform="translate(-50%,0)",r.style.left=u+"%",this.el.b.fg.style.width=w+"%",this.el.b.fg.style.left=M+"%",t!==l&&i&&this.fire("change",this.range?this.val:this.val[o]),this.input)return this.updateInput({now:!e})}}),"undefined"!=typeof module&&null!==module?module.exports=i:"undefined"!=typeof window&&null!==window&&(window.ldSlider=window.ldslider=i)}).call(this);
